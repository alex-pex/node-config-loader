{"version":3,"sources":["../src/utils/scanner.js"],"names":[],"mappings":";;;;;kBASwB,WAAW;;;;;;;;;;;;;;;;AANnC,IAAM,KAAK,GAAG,qBAAQ,kCAAkC,CAAC,CAAA;;AAEzD,SAAS,QAAQ,CAAC,CAAC,EAAE;AACjB,WAAO,eAAK,QAAQ,CAAC,CAAC,CAAC,CAAA;CAC1B;;AAEc,SAAS,WAAW,OAAkB;QAAhB,KAAK,QAAL,KAAK;QAAE,MAAM,QAAN,MAAM;;AAC9C,WAAO,SAAS,OAAO,CAAC,KAAK,EAAE;AAC3B,eAAO,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CACxB,IAAI,CAAC,UAAA,aAAa,EAAI;AACnB,iBAAK,CAAC,cAAc,EAAE,aAAa,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,CAAA;AAClD,mBAAO,OAAO,CAAC,GAAG,CAAC,aAAa,CAAC,GAAG,CAAC,UAAA,IAAI;uBAAI,wBAAS,IAAI,CAAC;aAAA,CAAC,CAAC,CACxD,IAAI,CAAC,UAAA,KAAK;uBACP,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,UAAC,QAAQ,EAAE,CAAC;2BAC9B,MAAM,CAAC;AACH,gCAAQ,EAAR,QAAQ;AACR,4BAAI,EAAE,aAAa,CAAC,CAAC,CAAC;qBACzB,CAAC;iBAAA,CACL,CAAC;aAAA,CACL,CAAA;SACR,CAAC,CACD,IAAI,CAAC,UAAA,OAAO;mBACT,OAAO,CAAC,MAAM,CAAC,UAAC,GAAG,EAAE,MAAM;uBAAK,KAAK,CAAC,GAAG,EAAE,MAAM,CAAC;aAAA,EAAE,EAAE,CAAC;SAAA,CAC1D,CAAA;KACR,CAAA;CACJ","file":"scanner.js","sourcesContent":["import readFile from './readFile'\nimport __debug from 'debug'\nimport path from 'path'\nconst debug = __debug('node-config-loader:scanner:debug')\n\nfunction basename(p) {\n    return path.basename(p)\n}\n\nexport default function makeScanner({merge, parser}) {\n    return function scanner(files) {\n        return Promise.resolve(files)\n            .then(filteredFiles => {\n                debug('filtered: %o', filteredFiles.map(basename))\n                return Promise.all(filteredFiles.map(file => readFile(file)))\n                    .then(datas =>\n                        Promise.all(datas.map((contents, i) =>\n                            parser({\n                                contents,\n                                path: filteredFiles[i]\n                            })\n                        ))\n                    )\n            })\n            .then(objects =>\n                objects.reduce((acc, object) => merge(acc, object), {})\n            )\n    }\n}\n"]}